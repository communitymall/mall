(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41a4ce4a"],{"24eb":function(t,e,n){"use strict";n.r(e);var o,a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"order"},[n("van-cell-group",[n("van-cell",{attrs:{isLink:"",title:"收货信息"},on:{click:function(e){return t.goAddressList()}}},[n("div",{attrs:{slot:"label"},slot:"label"},[n("div",[n("span",[t._v(t._s(t.merchantInfo.consigneeName)+" ")]),n("span",[t._v(t._s(t.merchantInfo.consigneePhone)+" ")])]),n("div",[t._v("\n                    "+t._s(t.merchantInfo.merchantAddress)+"\n                ")])])])],1),n("van-cell-group",[n("van-cell",{staticClass:"order-coupon",attrs:{title:"优惠券","is-link":"",value:t.getCouponValue()},on:{click:t.getCoupons}})],1),n("van-popup",{attrs:{position:"bottom"},model:{value:t.showList,callback:function(e){t.showList=e},expression:"showList"}},[n("van-coupon-list",{attrs:{coupons:t.coupons,"chosen-coupon":t.chosenCoupon,"disabled-coupons":t.disabledCoupons},on:{change:t.onChange,exchange:t.onExchange}})],1),n("van-cell-group",[n("van-cell",{staticClass:"order-coupon",attrs:{title:"支付类型","is-link":"",value:t.getPayType()},on:{click:t.getPay}}),n("van-popup",{attrs:{position:"top"},model:{value:t.payShow,callback:function(e){t.payShow=e},expression:"payShow"}},[n("van-cell-group",[n("van-cell",{attrs:{title:"在线支付",clickable:""},on:{click:t.setPayType1}}),n("van-cell",{attrs:{title:"货到付款",clickable:""},on:{click:t.setPayType2}})],1)],1)],1),t._l(t.checkedGoodsList,function(t){return n("van-card",{key:t.id,attrs:{title:t.goodsName,num:t.number,price:t.price,thumb:t.picUrl}})}),n("van-cell-group",[n("van-cell",{attrs:{title:"商品金额"}},[n("span",{staticClass:"red"},[t._v(t._s(t._f("yuan")(100*t.goodsTotalPrice)))])]),n("van-cell",{attrs:{title:"邮费"}},[n("span",{staticClass:"red"},[t._v(t._s(t._f("yuan")(100*t.freightPrice)))])]),n("van-cell",{attrs:{title:"优惠券"}},[n("span",{staticClass:"red"},[t._v("-"+t._s(t._f("yuan")(100*t.couponPrice)))])]),n("van-field",{attrs:{placeholder:"请输入备注",label:"订单备注"},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}},[n("template",{slot:"icon"},[t._v(t._s(t.message.length)+"/50")])],2)],1),n("van-submit-bar",{attrs:{price:100*t.actualPrice,label:"总计：",buttonText:"提交订单",disabled:t.isDisabled},on:{submit:t.onSubmit}})],2)},i=[],s=(n("8a58"),n("e41f")),c=(n("e324"),n("453b")),r=(n("b76c"),n("ac3c")),l=(n("5f1a"),n("a3e2")),u=(n("be7f"),n("565f")),d=(n("9cb7"),n("66fd")),p=(n("be39"),n("efa0")),f=(n("7f7f"),n("bd86")),h=(n("e7e5"),n("d399")),b=(n("68ef"),n("aec8"),n("d282")),v=n("6aa9"),m=n("9884"),g=n("2b0e"),y=n("1325"),I=function(t){return g["a"].extend({props:{closeOnClickOutside:{type:Boolean,default:!0}},data:function(){var e=this,n=function(n){e.closeOnClickOutside&&!e.$el.contains(n.target)&&e[t.method]()};return{clickOutsideHandler:n}},mounted:function(){Object(y["b"])(document,t.event,this.clickOutsideHandler)},beforeDestroy:function(){Object(y["a"])(document,t.event,this.clickOutsideHandler)}})},O=Object(b["a"])("dropdown-menu"),C=O[0],k=O[1],w=C({mixins:[Object(m["b"])("vanDropdownMenu"),I({event:"click",method:"onClickOutside"})],props:{overlay:{type:Boolean,default:!0},zIndex:{type:Number,default:10},duration:{type:Number,default:.2},direction:{type:String,default:"down"},activeColor:{type:String,default:v["a"]},closeOnClickOverlay:{type:Boolean,default:!0}},data:function(){return{offset:0}},methods:{updateOffset:function(){var t=this.$refs.menu,e=t.getBoundingClientRect();"down"===this.direction?this.offset=e.bottom:this.offset=window.innerHeight-e.top},toggleItem:function(t){this.children.forEach(function(e,n){n===t?e.toggle():e.showPopup&&e.toggle(!1,{immediate:!0})})},onClickOutside:function(){this.children.forEach(function(t){t.toggle(!1)})}},render:function(){var t=this,e=arguments[0],n=this.children.map(function(n,o){return e("div",{attrs:{role:"button",tabindex:n.disabled?-1:0},class:k("item",{disabled:n.disabled}),on:{click:function(){n.disabled||t.toggleItem(o)}}},[e("span",{class:[k("title",{down:n.showPopup===("down"===t.direction)}),n.titleClass],style:{color:n.showPopup?t.activeColor:""}},[e("div",{class:"van-ellipsis"},[n.displayTitle])])])});return e("div",{ref:"menu",class:[k(),"van-hairline--top-bottom"]},[n,this.slots("default")])}}),P=(n("09fe"),n("4d75"),n("b2cc"),n("7744")),j=n("ad06"),x=Object(b["a"])("dropdown-item"),S=x[0],T=x[1],L=S({mixins:[Object(m["a"])("vanDropdownMenu")],props:{value:null,title:String,disabled:Boolean,titleClass:String,options:{type:Array,default:function(){return[]}}},data:function(){return{transition:!0,showPopup:!1,showWrapper:!1}},computed:{displayTitle:function(){var t=this;if(this.title)return this.title;var e=this.options.filter(function(e){return e.value===t.value});return e.length?e[0].text:""}},methods:{toggle:function(t,e){void 0===t&&(t=!this.showPopup),void 0===e&&(e={}),t!==this.showPopup&&(this.transition=!e.immediate,this.showPopup=t,t&&(this.parent.updateOffset(),this.showWrapper=!0))}},beforeCreate:function(){var t=this,e=function(e){return function(){return t.$emit(e)}};this.onOpen=e("open"),this.onClose=e("close"),this.onOpened=e("opened")},render:function(){var t=this,e=arguments[0],n=this.parent,o=n.zIndex,a=n.offset,i=n.overlay,c=n.duration,r=n.direction,l=n.activeColor,u=n.closeOnClickOverlay,d=this.options.map(function(n){var o=n.value===t.value;return e(P["a"],{attrs:{clickable:!0,icon:n.icon,title:n.text},key:n.value,style:{color:o?l:""},on:{click:function(){t.showPopup=!1,n.value!==t.value&&(t.$emit("input",n.value),t.$emit("change",n.value))}}},[o&&e(j["a"],{class:T("icon"),attrs:{color:l,name:"success"}})])}),p={zIndex:o};return"down"===r?p.top=a+"px":p.bottom=a+"px",e("div",{directives:[{name:"show",value:this.showWrapper}],style:p,class:T([r])},[e(s["a"],{attrs:{overlay:i,position:"down"===r?"top":"bottom",duration:this.transition?c:0,closeOnClickOverlay:u,overlayStyle:{position:"absolute"}},class:T("content"),on:{open:this.onOpen,close:this.onClose,opened:this.onOpened,closed:function(){t.showWrapper=!1,t.$emit("closed")}},model:{value:t.showPopup,callback:function(e){t.showPopup=e}}},[d,this.slots("default")])])}}),_=n("4ec3"),B=n("3c96");n("5a0c");g["a"].use(w).use(L);var A={data:function(){return{checkedGoodsList:[],checkedAddress:{},merchantInfo:{},consigneeInfo:{},consigneeId:-1,payType:0,availableCouponLength:0,goodsTotalPrice:0,freightPrice:0,couponPrice:0,grouponPrice:0,orderTotalPrice:0,actualPrice:0,message:"",show:"",isDisabled:!1,showList:!1,payShow:!1,chosenCoupon:-1,coupons:[],disabledCoupons:[],option:[{text:"请选择支付类型",value:0},{text:"在线支付",value:1},{text:"货到付款",value:2}]}},created:function(){this.init()},methods:{onSubmit:function(){var t=this,e=Object(B["a"])("CartId","CouponId"),n=e.CartId,o=e.CouponId;if(0!==this.payType)if(void 0!==this.merchantInfo.merchantAddress){var a=Object(B["a"])("storeId"),i=a.storeId;null!==i?(this.isDisabled=!0,Object(_["fb"])(Object(f["a"])({storeId:this.$route.query.storeId,cartId:n,couponId:o,grouponLinkId:0,grouponRulesId:0,message:this.message,payType:this.payType},"storeId",i)).then(function(e){if(Object(B["c"])({storeId:0,CartId:0,CouponId:0}),2!=t.payType){var n=e.data.data.orderId;t.$router.push({name:"payment",params:{orderId:n}})}else t.$router.push({name:"payResult",params:{orderId:n}})}).catch(function(e){t.isDisabled=!1,t.$toast("下单失败")})):h["a"].fail("请设置收货门店")}else h["a"].fail("该门店没有设置收货地址");else h["a"].fail("请选择支付类型")},goAddressList:function(){this.$router.push({path:"/user/selectMerchant"})},getCouponValue:function(){return 0!==this.couponPrice?"-¥"+this.couponPrice+".00元":0!==this.availableCouponLength?this.availableCouponLength+"张可用":"没有可用优惠券"},getPayType:function(){return 1==this.payType?"在线支付":2==this.payType?"货到付款":"请选择支付类型"},setPayType1:function(){this.payType=1,this.payShow=!1},setPayType2:function(){this.payType=2,this.payShow=!1},getCoupons:function(){var t=this,e=Object(B["a"])("AddressId","CartId","CouponId"),n=(e.AddressId,e.CartId);e.CouponId;Object(_["F"])({cartId:n,grouponRulesId:0}).then(function(e){var n=e.data.data;t.coupons=[];for(var o=0;o<n.length;o++){var a=n[o],i={id:a.id,name:a.name,condition:a.min,value:100*a.discount,description:a.desc,startAt:new Date(a.startTime).getTime()/1e3,endAt:new Date(a.endTime).getTime()/1e3,valueDesc:a.discount,unitDesc:"元"};if(t.coupons.push(i),a.id===t.couponId){t.chosenCoupon=o;break}}t.showList=!0})},getPay:function(){this.payShow=!0},init:function(){var t=this,e=Object(B["a"])("AddressId","CartId","CouponId"),n=(e.AddressId,e.CartId),o=e.CouponId;Object(_["s"])({cartId:n,couponId:o,grouponRulesId:0}).then(function(e){var n=e.data.data;t.checkedGoodsList=n.checkedGoodsList,t.checkedAddress=n.checkedAddress,t.availableCouponLength=n.availableCouponLength,t.actualPrice=n.actualPrice,t.couponPrice=n.couponPrice,t.grouponPrice=n.grouponPrice,t.freightPrice=n.freightPrice,t.goodsTotalPrice=n.goodsTotalPrice,t.orderTotalPrice=n.orderTotalPrice,Object(B["c"])({AddressId:n.addressId,CartId:n.cartId,CouponId:n.couponId})});var a=Object(B["a"])("storeId"),i=a.storeId;null!=i&&Object(_["T"])({storeId:i}).then(function(e){t.merchantInfo=e.data.data,t.consigneeId=e.data.data.consigneeId,-1!=t.consigneeId&&Object(_["I"])({id:t.consigneeId}).then(function(e){t.merchantInfo.merchantLeader=e.data.data.name,t.merchantInfo.merchantPhone=e.data.data.mobile}).catch(function(t){})}).catch(function(t){})},onChange:function(t){if(this.showList=!1,this.chosenCoupon=t,-1===t)Object(B["c"])({CouponId:-1});else{var e=this.coupons[t].id;Object(B["c"])({CouponId:e})}this.init()},onExchange:function(){this.$toast("兑换暂不支持")}},components:(o={},Object(f["a"])(o,h["a"].name,h["a"]),Object(f["a"])(o,p["a"].name,p["a"]),Object(f["a"])(o,d["a"].name,d["a"]),Object(f["a"])(o,u["a"].name,u["a"]),Object(f["a"])(o,l["a"].name,u["a"]),Object(f["a"])(o,r["a"].name,r["a"]),Object(f["a"])(o,c["a"].name,c["a"]),Object(f["a"])(o,s["a"].name,s["a"]),o)},$=A,D=(n("6654"),n("2877")),N=Object(D["a"])($,a,i,!1,null,"05120644",null);e["default"]=N.exports},"3b42":function(t,e,n){},"5f1a":function(t,e,n){"use strict";n("68ef"),n("9b7e")},6654:function(t,e,n){"use strict";var o=n("719c"),a=n.n(o);a.a},"66fd":function(t,e,n){"use strict";var o=n("2638"),a=n.n(o),i=n("d282"),s=n("a142"),c=n("ba31"),r=n("a3e2"),l=n("44bf"),u=Object(i["a"])("card"),d=u[0],p=u[1];function f(t,e,n,o){var i=e.thumb,u=n.num||Object(s["b"])(e.num),d=n.price||Object(s["b"])(e.price),f=n["origin-price"]||Object(s["b"])(e.originPrice),h=u||d||f;function b(t){Object(c["a"])(o,"click-thumb",t)}function v(){if(n.tag||e.tag)return t("div",{class:p("tag")},[n.tag?n.tag():t(r["a"],{attrs:{mark:!0,type:"danger"}},[e.tag])])}function m(){if(n.thumb||i)return t("a",{attrs:{href:e.thumbLink},class:p("thumb"),on:{click:b}},[n.thumb?n.thumb():t(l["a"],{attrs:{src:i,width:"100%",height:"100%",fit:"contain","lazy-load":e.lazyLoad}}),v()])}function g(){return n.title?n.title():e.title?t("div",{class:p("title")},[e.title]):void 0}function y(){return n.desc?n.desc():e.desc?t("div",{class:[p("desc"),"van-ellipsis"]},[e.desc]):void 0}function I(){if(d)return t("div",{class:p("price")},[n.price?n.price():e.currency+" "+e.price])}function O(){if(f){var o=n["origin-price"];return t("div",{class:p("origin-price")},[o?o():e.currency+" "+e.originPrice])}}function C(){if(u)return t("div",{class:p("num")},[n.num?n.num():"x "+e.num])}function k(){if(n.footer)return t("div",{class:p("footer")},[n.footer()])}return t("div",a()([{class:p()},Object(c["b"])(o,!0)]),[t("div",{class:p("header")},[m(),t("div",{class:p("content",{centered:e.centered})},[g(),y(),n.tags&&n.tags(),h&&t("div",{class:"van-card__bottom"},[I(),O(),C(),n.bottom&&n.bottom()])])]),k()])}f.props={tag:String,desc:String,thumb:String,title:String,centered:Boolean,lazyLoad:Boolean,thumbLink:String,num:[Number,String],price:[Number,String],originPrice:[Number,String],currency:{type:String,default:"¥"}},e["a"]=d(f)},"719c":function(t,e,n){},"8a58":function(t,e,n){"use strict";n("68ef"),n("4d75")},"9b7e":function(t,e,n){},"9cb7":function(t,e,n){"use strict";n("68ef"),n("9b7e"),n("09fe"),n("ea82")},a3e2:function(t,e,n){"use strict";var o=n("2638"),a=n.n(o),i=n("d282"),s=n("ba31"),c=Object(i["a"])("tag"),r=c[0],l=c[1];function u(t,e,n,o){var i,c=e.type,r=e.mark,u=e.plain,d=e.color,p=e.round,f=e.size,h=u?"color":"backgroundColor",b=(i={},i[h]=d,i);e.textColor&&(b.color=e.textColor);var v={mark:r,plain:u,round:p};return f&&(v[f]=f),t("span",a()([{style:b,class:[l([v,c]),{"van-hairline--surround":u}]},Object(s["b"])(o,!0)]),[n.default&&n.default()])}u.props={size:String,mark:Boolean,color:String,plain:Boolean,round:Boolean,textColor:String,type:{type:String,default:"default"}},e["a"]=r(u)},aec8:function(t,e,n){},b2cc:function(t,e,n){},be39:function(t,e,n){"use strict";n("68ef"),n("09fe"),n("3b42")},be7f:function(t,e,n){"use strict";n("68ef"),n("09fe"),n("1146")},e41f:function(t,e,n){"use strict";var o=n("d282"),a=n("a142"),i=n("6605"),s=Object(o["a"])("popup"),c=s[0],r=s[1];e["a"]=c({mixins:[i["a"]],props:{round:Boolean,duration:Number,transition:String,position:{type:String,default:"center"},overlay:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!0}},beforeCreate:function(){var t=this,e=function(e){return function(n){return t.$emit(e,n)}};this.onClick=e("click"),this.onOpened=e("opened"),this.onClosed=e("closed")},render:function(){var t,e=arguments[0];if(this.shouldRender){var n=this.round,o=this.position,i=this.duration,s=this.transition||("center"===o?"van-fade":"van-popup-slide-"+o),c={};return Object(a["b"])(i)&&(c.transitionDuration=i+"s"),e("transition",{attrs:{name:s},on:{afterEnter:this.onOpened,afterLeave:this.onClosed}},[e("div",{directives:[{name:"show",value:this.value}],style:c,class:r((t={round:n},t[o]=o,t)),on:{click:this.onClick}},[this.slots()])])}}})},ea82:function(t,e,n){},efa0:function(t,e,n){"use strict";var o=n("2638"),a=n.n(o),i=n("d282"),s=n("ba31"),c=n("b650"),r=n("ad06"),l=Object(i["a"])("submit-bar"),u=l[0],d=l[1],p=l[2];function f(t,e,n,o){var i=e.tip,l=e.price,u=e.tipIcon;function f(){if("number"===typeof l){var n=e.currency+" "+(l/100).toFixed(e.decimalLength);return t("div",{class:d("text")},[t("span",[e.label||p("label")]),t("span",{class:d("price")},[n]),e.suffixLabel&&t("span",{class:d("suffix-label")},[e.suffixLabel])])}}function h(){if(n.tip||i)return t("div",{class:d("tip")},[u&&t(r["a"],{class:d("tip-icon"),attrs:{name:u}}),i&&t("span",{class:d("tip-text")},[i]),n.tip&&n.tip()])}return t("div",a()([{class:d({"safe-area-inset-bottom":e.safeAreaInsetBottom})},Object(s["b"])(o)]),[n.top&&n.top(),h(),t("div",{class:d("bar")},[n.default&&n.default(),f(),t(c["a"],{attrs:{square:!0,size:"large",type:e.buttonType,loading:e.loading,disabled:e.disabled,text:e.loading?"":e.buttonText},class:d("button"),on:{click:function(){Object(s["a"])(o,"submit")}}})])])}f.props={tip:String,label:String,price:Number,tipIcon:String,loading:Boolean,disabled:Boolean,buttonText:String,suffixLabel:String,safeAreaInsetBottom:Boolean,decimalLength:{type:Number,default:2},currency:{type:String,default:"¥"},buttonType:{type:String,default:"danger"}},e["a"]=u(f)}}]);